plot.title = element_text(hjust = 0.5)
)
pitch_usage
pitch_usage$BatterSide <- factor(
pitch_usage$BatterSide,
levels = c("Left", "Right")
)
pitch_usage
# df for count situation, so it can be labeled in the center
center_labels <- pitch_usage %>%
distinct(CountSituation, BatterSide) %>%
mutate(
CountSituation = factor(CountSituation, levels = c("Overall", "Hitter Ahead", "Pitcher Ahead")),
BatterSide = factor(BatterSide, levels = c("Left", "Right")),
x = 2,
y = 0,
label = CountSituation
)
p3 <- pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(CountSituation ~ BatterSide, labeller = label_value) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white"
) +
geom_text(
data = center_labels,
aes(x = x, y = y, label = label),
inherit.aes = FALSE,
size = 4,
fontface = "bold"
) +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_blank(),
strip.text.x = element_text(size = 12, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
p3
p3 <- pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(CountSituation ~ BatterSide, labeller = label_value) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white"
) +
geom_text(
data = center_labels,
aes(x = x, y = y, label = label),
inherit.aes = FALSE,
size = 4,
fontface = "bold"
) +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_blank(),
strip.text.x = element_text(size = 12, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
p3
p3 + facet_grid(CountSituation ~ BatterSide, labeller = label_value)
p3 <- pitch_usage %>%
ggplot(aes(x = 3, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(CountSituation ~ BatterSide, labeller = label_value) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white"
) +
geom_text(
data = center_labels,
aes(x = 2, y = 0, label = label),
inherit.aes = FALSE,
size = 4, fontface = "bold"
) +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_blank(),
strip.text.x = element_text(size = 12, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
p3
p3 <- pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(CountSituation ~ BatterSide, labeller = label_value) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white"
) +
geom_text(
data = center_labels,
aes(x = 2, y = 0, label = label),
inherit.aes = FALSE,
size = 4, fontface = "bold"
) +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_blank(),
strip.text.x = element_text(size = 12, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
p3
# df for count situation, so it can be labeled in the center
center_labels <- pitch_usage %>%
distinct(CountSituation, BatterSide) %>%
mutate(x = 3, y = 0, label = CountSituation)
p3 <- pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(CountSituation ~ BatterSide, labeller = label_value) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white"
) +
geom_text(
data = center_labels,
aes(x = 2, y = 0, label = label),
inherit.aes = FALSE,
size = 4, fontface = "bold"
) +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_blank(),
strip.text.x = element_text(size = 12, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
p3
p3 <- pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(CountSituation ~ BatterSide, labeller = label_value) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white"
) +
geom_text(
data = center_labels,
aes(x = 2, y = 0, label = label),
inherit.aes = FALSE,
size = 3, fontface = "bold"
) +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_blank(),
strip.text.x = element_text(size = 12, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
p3
p3 <- pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(CountSituation ~ BatterSide, labeller = label_value) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white"
) +
geom_text(
data = center_labels,
aes(x = 2, y = 1.15, label = label),
inherit.aes = FALSE,
size = 4, fontface = "bold"
) +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_blank(),
strip.text.x = element_text(size = 12, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
p3
TrackMan_Combined_2025 %>% filter(Pitcher == "Schaefer, Derek")
TrackMan_Combined_2025 %>% filter(Pitcher == "Schaefer, Derek", Date == "2025-04-29")
SynergyVideoPitcher <- TrackMan_Combined_2025 %>% filter(Pitcher == "Schaefer, Derek", Date == "2025-04-29")
write_csv(SynergyVideoPitcher, "~/Downloads/Schaefer.csv")
reticulate::repl_python()
setwd("/Users/zacharyaisen/Desktop/Brewster Opposing Starter Videos/Yarmouth-Dennis/Schaefer YD")
reticulate::repl_python()
(p1 + p2 + p3) +
plot_layout(widths = c(1, 2, 1), heights = c(2, 2, 2))
p3 <- pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(CountSituation ~ BatterSide) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white"
) +
geom_text(
data = center_labels,
inherit.aes = FALSE,
size = 4, fontface = "bold"
) +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_blank(),
strip.text.x = element_text(size = 12, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
p3
pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(CountSituation ~ BatterSide) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white") +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_blank(),
strip.text.x = element_text(size = 12, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(CountSituation ~ BatterSide) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white") +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_text(size = 10, face = "bold"),
strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
p3 <- pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(CountSituation ~ BatterSide) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white") +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_text(size = 10, face = "bold"),
strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(BatterSide ~ CountSituation) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white") +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_text(size = 10, face = "bold"),
strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
(p1 + p2 / p3) +
plot_layout(widths = c(1, 2, 2), heights = c(2, 2, 1))
p3 <- pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y", clip = "off") +
facet_grid(BatterSide ~ CountSituation) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white") +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_text(size = 10, face = "bold"),
strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
(p1 + p2 / p3) +
plot_layout(widths = c(1, 2, 2), heights = c(2, 2, 1))
((p1 + p2) / p3) +
plot_layout(widths = c(1, 2, 2), heights = c(2, 2, 1))
((p1 + p2) / p3) +
plot_layout(widths = c(1, 2, 3), heights = c(2, 2, 1))
pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
facet_grid(BatterSide ~ CountSituation) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white") +
xlim(0.5, 2.5) +
theme(
aspect.ratio = 1,
legend.position = "none",
strip.text.y = element_text(size = 10, face = "bold"),
strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
facet_grid(BatterSide ~ CountSituation) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white") +
xlim(0.5, 2.5) +
theme(
legend.position = "none",
strip.text.y = element_text(size = 10, face = "bold"),
strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y") +
facet_grid(BatterSide ~ CountSituation) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white") +
xlim(0.5, 2.5) +
theme(
legend.position = "none",
strip.text.y = element_text(size = 10, face = "bold"),
strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
pitch_usage %>%
ggplot(aes(x = 2, y = UsagePct, fill = TaggedPitchType)) +
geom_col(width = 1, color = "white") +
coord_polar(theta = "y") +
facet_grid(BatterSide ~ CountSituation) +
theme_void() +
scale_fill_manual(values = TMcolors) +
geom_label_repel(
aes(label = Label),
position = position_stack(vjust = 0.5),
size = 3,
box.padding = 0,
color = "white") +
theme(
legend.position = "none",
strip.text.y = element_text(size = 10, face = "bold"),
strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(hjust = 0.5)
)
Pitcher <- TrackMan_Combined_2025 %>% filter(Pitcher == "Schaefer, Derek")
write_csv(SynergyVideoPitcher, "~/Downloads/Schaefer.csv")
write_csv(Pitcher, "~/Downloads/StartingPitcher.csv")
reticulate::repl_python()
setwd("/Users/zacharyaisen/Desktop/Brewster Opposing Starter Videos/Harwich/Twist Harwich")
reticulate::repl_python()
Pitcher <- TrackMan_Combined_2025 %>% filter(Pitcher == "Twist, Toby")
write_csv(Pitcher, "~/Downloads/StartingPitcher.csv")
Pitcher <- TrackMan_Combined_2025 %>% filter(Pitcher == "Magdelano, Isaiah")
Pitcher
Pitcher <- TrackMan_Combined_2025 %>% filter(Pitcher == "Magdaleno, Isaiah")
Pitcher
write_csv(Pitcher, "~/Downloads/StartingPitcher.csv")
TrackMan_Combined_2025 %>% filter(Pitcher == "Magdaleno, Isaiah")
TrackMan_Combined_2025 %>% filter(Pitcher == "Magdaleno, Isaiah", Date == "2025-05-23")
TrackMan_Combined_2025 %>% filter(Pitcher == "Magdaleno, Isaiah", Date == "2025-05-09")
SynergyVideoPitcher <- TrackMan_Combined_2025 %>% filter(Pitcher == "Magdaleno, Isaiah", Date == "2025-05-09")
write_csv(SynergyVideoPitcher, "~/Downloads/Schaefer.csv")
write_csv(SynergyVideoPitcher, "~/Downloads/Magdaleno.csv")
TMfile = pandas.read_csv("~/Downloads/Magdaleno.csv")  # Load Trackman CSV data
reticulate::repl_python()
setwd("/Users/zacharyaisen/Desktop/Brewster Opposing Starter Videos/Orleans/Magdaleno Orleans")
reticulate::repl_python()
runApp('~/Downloads/ShinyAppCurrent.R')
setwd("/Users/zacharyaisen/Coding stuff/current stuff/CURRENT/ShinyApp")
runApp('~/Downloads/ShinyAppCurrent.R')
setwd("/Users/zacharyaisen/Coding stuff/current stuff/CURRENT/ShinyApp")
runApp('~/Downloads/ShinyAppCurrent.R')
wd
wd()
library(caret)
library(tidymodels)
library(caret)
library(tidymodels)
d1 <- TrackMan_Combined_2025
#GEN CLASS RHP
#Clean data
d1$TaggedPitchType <- ifelse(d1$TaggedPitchType %in% c("Cutter","Curveball","Slider","Sweeper"),"BB",
ifelse(d1$TaggedPitchType %in% c("Fastball","Sinker"),"FB",
d1$TaggedPitchType))
d2 <- d1 %>%
filter(TaggedPitchType %in% c("FB","CH","BB") & PitcherThrows == "Right") %>%
select(TaggedPitchType,RelSpeed,SpinRate,HorzBreak,InducedVertBreak,SpinAxis) %>%
na.omit() %>%
filter(HorzBreak >= -25 & HorzBreak <= 25 &
InducedVertBreak >= -25 & InducedVertBreak <= 25 &
SpinRate < 3000 & SpinRate > 700 & RelSpeed > 65)
fb <- d2 %>% filter(TaggedPitchType == "FB" & HorzBreak >= -2 & InducedVertBreak > -2)
ch <- d2 %>% filter(TaggedPitchType == "CH" & HorzBreak >= -4 & InducedVertBreak > -4)
bb <- d2 %>% filter(TaggedPitchType == "BB" & HorzBreak <= 3)
d2 <- rbind(fb,ch,bb)
data <- d2 %>% group_by(TaggedPitchType) %>% sample_n(25000) %>% ungroup()
table(data$TaggedPitchType)
ggplot(data,aes(HorzBreak,InducedVertBreak,color = TaggedPitchType)) + geom_point()
write_feather(data,"data/cleanedknn.feather")
reticulate::repl_python()
